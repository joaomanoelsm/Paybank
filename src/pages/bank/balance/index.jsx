import React, { useState } from 'react';
import { useSelector } from 'react-redux/es/exports';
import { selectUser } from '../../../store/useSlice';
import { useRef } from 'react';

const Balance = () => {
  let [ icon, setIcon ] = useState(true)

  const balanceRef = useRef()
  const iconRef = useRef()

  const { balance, themeToggle } = useSelector(selectUser)

  const convertNumberToCurrency = ( currency ) => {
    return currency.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL', minimumFractionDigits: 2}) 
  } 

  React.useEffect( () => {
    if ( icon ) balanceRef.current.innerText = convertNumberToCurrency( balance ) 
    else balanceRef.current.innerText = 'R$ ****'

    if ( themeToggle ) iconRef.current.classList.add('balance__icon--dark-mode')
    else iconRef.current.classList.add('balance__icon--light-mode')
  }, [ icon, balance, themeToggle ])


  return (
    <section id='balance'>
         <div id='balance__title'>
            <h2>Balance</h2>
         </div>
         <div id='balance__view'>
            <span ref={ balanceRef }>{ balance }</span>
            <svg ref={ iconRef } className='balance__icon' onClick={ () => setIcon( state => !state ) } width="56" height="38" viewBox="0 0 56 38" fill="#13123F" xmlns="http://www.w3.org/2000/svg">
              { icon ? <path d="M28 30C31.125 30 33.7817 28.9067 35.97 26.72C38.1567 24.5317 39.25 21.875 39.25 18.75C39.25 15.625 38.1567 12.9683 35.97 10.78C33.7817 8.59333 31.125 7.5 28 7.5C24.875 7.5 22.2183 8.59333 20.03 10.78C17.8433 12.9683 16.75 15.625 16.75 18.75C16.75 21.875 17.8433 24.5317 20.03 26.72C22.2183 28.9067 24.875 30 28 30ZM28 25.5C26.125 25.5 24.5317 24.8433 23.22 23.53C21.9067 22.2183 21.25 20.625 21.25 18.75C21.25 16.875 21.9067 15.2808 23.22 13.9675C24.5317 12.6558 26.125 12 28 12C29.875 12 31.4692 12.6558 32.7825 13.9675C34.0942 15.2808 34.75 16.875 34.75 18.75C34.75 20.625 34.0942 22.2183 32.7825 23.53C31.4692 24.8433 29.875 25.5 28 25.5ZM28 37.5C21.9167 37.5 16.375 35.8017 11.375 32.405C6.375 29.01 2.75 24.4583 0.5 18.75C2.75 13.0417 6.375 8.48917 11.375 5.0925C16.375 1.6975 21.9167 0 28 0C34.0833 0 39.625 1.6975 44.625 5.0925C49.625 8.48917 53.25 13.0417 55.5 18.75C53.25 24.4583 49.625 29.01 44.625 32.405C39.625 35.8017 34.0833 37.5 28 37.5ZM28 32.5C32.7083 32.5 37.0317 31.26 40.97 28.78C44.9067 26.3017 47.9167 22.9583 50 18.75C47.9167 14.5417 44.9067 11.1975 40.97 8.7175C37.0317 6.23917 32.7083 5 28 5C23.2917 5 18.9683 6.23917 15.03 8.7175C11.0933 11.1975 8.08333 14.5417 6 18.75C8.08333 22.9583 11.0933 26.3017 15.03 28.78C18.9683 31.26 23.2917 32.5 28 32.5Z" fill="#13123F"/> 
              : <path d="M37.75 26.25L34.125 22.625C34.5 20.6667 33.9375 18.8333 32.4375 17.125C30.9375 15.4167 29 14.75 26.625 15.125L23 11.5C23.7083 11.1667 24.4267 10.9167 25.155 10.75C25.885 10.5833 26.6667 10.5 27.5 10.5C30.625 10.5 33.2817 11.5933 35.47 13.78C37.6567 15.9683 38.75 18.625 38.75 21.75C38.75 22.5833 38.6667 23.365 38.5 24.095C38.3333 24.8233 38.0833 25.5417 37.75 26.25ZM45.75 34.125L42.125 30.625C43.7083 29.4167 45.115 28.0933 46.345 26.655C47.5733 25.2183 48.625 23.5833 49.5 21.75C47.4167 17.5417 44.4267 14.1975 40.53 11.7175C36.635 9.23917 32.2917 8 27.5 8C26.2917 8 25.1042 8.08333 23.9375 8.25C22.7708 8.41667 21.625 8.66667 20.5 9L16.625 5.125C18.3333 4.41667 20.0833 3.885 21.875 3.53C23.6667 3.17667 25.5417 3 27.5 3C33.7917 3 39.3958 4.73917 44.3125 8.2175C49.2292 11.6975 52.7917 16.2083 55 21.75C54.0417 24.2083 52.7817 26.49 51.22 28.595C49.6567 30.6983 47.8333 32.5417 45.75 34.125ZM47 49.5L36.5 39.125C35.0417 39.5833 33.5733 39.9275 32.095 40.1575C30.615 40.3858 29.0833 40.5 27.5 40.5C21.2083 40.5 15.6042 38.7608 10.6875 35.2825C5.77083 31.8025 2.20833 27.2917 0 21.75C0.875 19.5417 1.97917 17.4892 3.3125 15.5925C4.64583 13.6975 6.16667 12 7.875 10.5L1 3.5L4.5 0L50.5 46L47 49.5ZM11.375 14C10.1667 15.0833 9.0625 16.2708 8.0625 17.5625C7.0625 18.8542 6.20833 20.25 5.5 21.75C7.58333 25.9583 10.5725 29.3017 14.4675 31.78C18.3642 34.26 22.7083 35.5 27.5 35.5C28.3333 35.5 29.1458 35.4483 29.9375 35.345C30.7292 35.24 31.5417 35.125 32.375 35L30.125 32.625C29.6667 32.75 29.2292 32.8433 28.8125 32.905C28.3958 32.9683 27.9583 33 27.5 33C24.375 33 21.7183 31.9067 19.53 29.72C17.3433 27.5317 16.25 24.875 16.25 21.75C16.25 21.2917 16.2808 20.8542 16.3425 20.4375C16.4058 20.0208 16.5 19.5833 16.625 19.125L11.375 14Z" fill="#13123F"/> }
            </svg>
         </div>
    </section>
  )
}

export default Balance